apiVersion: v1
kind: ConfigMap
metadata:
  name: kagent-blueprint
  namespace: authentik
  labels:
    app.kubernetes.io/name: authentik-blueprint
    app.kubernetes.io/component: kagent
data:
  kagent-proxy-assignment.yaml: |
    # yaml-language-server: $schema=https://goauthentik.io/blueprints/schema.json
    version: 1
    metadata:
      name: kagent-proxy-provider-assignment
      labels:
        blueprints.goauthentik.io/instantiate: "true"
        blueprints.goauthentik.io/description: "Assigns Kagent proxy provider to embedded outpost"
    entries:
      - model: authentik_outposts.outpost
        identifiers:
          managed: goauthentik.io/outposts/embedded
        state: present
        attrs:
          providers:
            - !Find [authentik_providers_proxy.proxyprovider, [name, kagent]]
